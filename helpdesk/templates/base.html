{% load static %}
<!doctype html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}HELPDESK{% endblock %}</title>

    <!-- Bootstrap -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

   <style>

/* ===========================================================
   1. ZMIENNE ‚Äì MOTYW JASNY
=========================================================== */
:root {
    --sidebar-bg: #151b26;
    --sidebar-bg-active: #111822;
    --sidebar-text: #c7cbd5;
    --sidebar-text-active: #ffffff;

    --page-bg: #f5f7fb;
    --content-bg: #ffffff;

    --border-subtle: #e3e7ed;
    --border-strong: #c4cad6;

    --accent: #2f80ed;
    --accent-soft: #e3efff;

    --danger: #e5494d;

    --radius-lg: 12px;
    --radius-xl: 18px;

    --shadow-soft: 0 8px 24px rgba(15, 23, 42, 0.08);

    --header-height: 56px;
    --layout-padding: 24px; /* NOWE ‚Äì ≈Çadne marginesy */
}

/* ===========================================================
   2. CIEMNY MOTYW ‚Äì tylko nadpisania
=========================================================== */
:root[data-theme="dark"] {
    --sidebar-bg: #0f0f15;
    --sidebar-bg-active: #14141d;
    --sidebar-text: #b0b6c3;

    --page-bg: #0d0d12;
    --content-bg: #1b1b23;

    --border-subtle: #2a2a33;
    --border-strong: #3a3a44;

    --accent: #4c8dff;
    --accent-soft: #233356;

    --danger: #f97373;
}

/* ===========================================================
   3. RESET / BAZA
=========================================================== */
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
    background: var(--page-bg);
    color: #1f2933;
}

:root[data-theme="dark"] body {
    color: #e5e7eb;
}

/* ===========================================================
   4. LAYOUT APLIKACJI
=========================================================== */
.app-shell {
    min-height: 100vh;
    display: flex;
    padding: var(--layout-padding);      /* üåü marginesy dooko≈Ça layoutu */
    padding-bottom: 0;
    gap: var(--layout-padding);
}

/* ========== LEWE MENU ========== */
.app-sidebar {
    width: 260px;
    background: var(--sidebar-bg);
    color: var(--sidebar-text);
    border-radius: var(--radius-xl);
    padding: 12px 0 18px;
    display: flex;
    flex-direction: column;
}

/* ========== PRAWA CZƒò≈öƒÜ ========== */
.app-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
}

.app-header {
    height: var(--header-height);
    background: var(--content-bg);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-soft);
    border: 1px solid var(--border-subtle);

    margin-bottom: 20px;

    padding: 0 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

/* ========== G≈Å√ìWNY CONTENT ========== */
.app-content {
    background: var(--content-bg);
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-soft);
    padding: 20px;
    min-height: 0;
}

.app-columns {
    display: grid;
    grid-template-columns: 1.8fr 1fr;
    gap: 20px;
}

@media (max-width: 992px) {
    .app-columns { grid-template-columns: 1fr; }
}

.column-main,
.column-side {
    background: var(--content-bg);
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-subtle);
    display: flex;
    flex-direction: column;
}

/* ===========================================================
   5. TABELA
=========================================================== */
:root[data-theme='dark'] .table,
:root[data-theme='dark'] .table td,
:root[data-theme='dark'] .table th {
    color: #e5e7eb !important;
}

:root[data-theme='dark'] .table th {
    background: #24242c !important;
}

:root[data-theme='dark'] .table-striped tbody tr:nth-child(odd) td {
    background: #1f1f27 !important;
}

:root[data-theme='dark'] .table-striped tbody tr:nth-child(even) td {
    background: #181820 !important;
}

:root[data-theme='dark'] .table-hover tbody tr:hover td {
    background: #2c2c36 !important;
}

:root[data-theme='dark'] table a {
    color: #82aaff !important;
}
:root[data-theme='dark'] table a:hover {
    color: #b4cdff !important;
    text-decoration: underline;
}

/* ===========================================================
   6. FORMULARZE / INPUTY
=========================================================== */
:root[data-theme="dark"] .form-select,
:root[data-theme="dark"] .form-control {
    background: #181820;
    border-color: #333;
    color: #e5e7eb;
}

/* ===========================================================
   7. PRZYCISKI
=========================================================== */
.header-action,
.btn {
    border-radius: 999px;
    padding: 6px 12px;
    border: 1px solid var(--border-subtle);
    cursor: pointer;
}

:root[data-theme="dark"] .header-action,
:root[data-theme="dark"] .btn {
    background: #1f1f28;
    border-color: #333;
    color: #e5e7eb;
}

/* ===========================================================
   8. BALONIKI WIADOMO≈öCI
=========================================================== */
:root[data-theme="dark"] .msg-bubble {
    background: #202030;
    border-color: #33334a;
}

/* ===========================================================
   9. PANELE BOCZNE
=========================================================== */
.side-section,
.side-header {
    background: var(--content-bg);
    border-color: var(--border-subtle);
}
/* ===========================================================
   10. BREADCRUMB + TYTU≈ÅY W NAG≈Å√ìWKU
=========================================================== */
.breadcrumb {
    margin: 0 0 4px 0;
    padding: 0;
    list-style: none !important;   /* üî• usuwa kropkƒô */
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.09em;
    color: #9ca3af;
}

.breadcrumb li {
    list-style: none !important;   /* na wszelki wypadek */
}

.breadcrumb li + li::before {
    content: "/";
    margin: 0 4px;
    color: #c4cad6;
}

.header-title {
    font-size: 17px;
    font-weight: 600;
    color: #111827;
}

.header-subtitle {
    font-size: 13px;
    color: #6b7280;
}

/* DARK MODE ‚Äì lepszy kontrast */
:root[data-theme="dark"] .header-title {
    color: #f9fafb;
}

:root[data-theme="dark"] .header-subtitle {
    color: #9ca3af;
}

:root[data-theme="dark"] .breadcrumb {
    color: #e5e7eb;
}

:root[data-theme="dark"] .breadcrumb li + li::before {
    color: #9ca3af;
}

:root[data-theme="dark"] .breadcrumb li:last-child {
    color: #ffffff;
    font-weight: 600;
}

.header-title {
    font-size: 17px;
    font-weight: 600;
    color: #111827;
}

.header-subtitle {
    font-size: 13px;
    color: #6b7280;
}

/* Dark mode ‚Äì lepszy kontrast */
:root[data-theme="dark"] .header-title {
    color: #f9fafb;
}

:root[data-theme="dark"] .header-subtitle {
    color: #9ca3af;
}


</style>


    {% block extra_head %}{% endblock %}
</head>
<body>
<div class="app-shell">

    <!-- LEWA NAWIGACJA -->
    <aside class="app-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">HELPDESK</div>
            <div class="sidebar-subtitle">Panel zg≈Çosze≈Ñ</div>
        </div>

        <div class="sidebar-section-label">Nawigacja</div>
        <ul class="sidebar-nav">
            <li class="sidebar-item">
                <a href="{% url 'helpdesk:dashboard' %}"
                   class="sidebar-link {% block nav_dashboard_active %}{% endblock %}">
                    <span class="sidebar-dot"></span>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="{% url 'helpdesk:zgloszenie_nowe' %}"
                   class="sidebar-link {% block nav_newticket_active %}{% endblock %}">
                    <span class="sidebar-dot"></span>
                    <span>Nowe zg≈Çoszenie</span>
                </a>
            </li>
            {% if request.user.is_superuser %}
            <li class="sidebar-item">
                <a href="{% url 'admin:index' %}" class="sidebar-link">
                    <span class="sidebar-dot"></span>
                    <span>Panel admina</span>
                </a>
            </li>
            {% endif %}
        </ul>

        <div class="sidebar-footer">
            <div class="sidebar-user">
                <div class="d-flex align-items-center gap-2">
                    <div class="avatar-sm"></div>
                    <div>
                        <div class="sidebar-user-name">
                            {{ request.user.get_full_name|default:request.user.username }}
                        </div>
                        <div class="sidebar-user-role">
                            {% if request.user.is_superuser %}Administrator{% else %}U≈ºytkownik{% endif %}
                        </div>
                    </div>
                </div>
                <form action="{% url 'logout' %}" method="post" class="m-0">
                    {% csrf_token %}
                    <button class="btn btn-sm btn-link text-light text-decoration-none p-0">‚èè</button>
                </form>
            </div>
        </div>
    </aside>

    <!-- PRAWA CZƒò≈öƒÜ -->
    <div class="app-main">
<header class="app-header">
   <!-- <div>
        <div class="header-title">{% block header_title %}Panel{% endblock %}</div>
        <div class="header-subtitle">{% block header_subtitle %}ZarzƒÖdzanie zg≈Çoszeniami{% endblock %}</div>
    </div>-->

    <div class="header-actions">
        <!-- PRZE≈ÅƒÑCZNIK MOTYWU -->
        <button id="theme-toggle" type="button" class="header-action">
            üåô Ciemny motyw
        </button>

        {% block header_actions %}
        <a href="{% url 'password_change' %}" class="header-action">Zmie≈Ñ has≈Ço</a>
        <a href="{% url 'helpdesk:zgloszenie_nowe' %}"
           class="header-action header-action-primary">Nowe zg≈Çoszenie</a>
        {% endblock %}
    </div>
</header>


        <main class="app-content">
            <div class="app-columns">
                <section class="column-main">
                    {% block main_column %}
                    <div class="column-main-header">Tre≈õƒá</div>
                    <div class="column-main-body">
                        Domy≈õlna zawarto≈õƒá.
                    </div>
                    {% endblock %}
                </section>

                <aside class="column-side">
                    {% block side_column %}
                    <div class="column-side-header">Panel boczny</div>
                    <div class="column-side-body">
                        Tu mo≈ºesz wstawiƒá statystyki, szczeg√≥≈Çy, filtry itp.
                    </div>
                    {% endblock %}
                </aside>
            </div>
        </main>
    </div>
</div>

<script>
(function () {
    const STORAGE_KEY = 'helpdesk-theme';
    const root = document.documentElement;
    let currentTheme = 'light';
    let toggleBtn = null;

    function applyTheme(theme) {
        currentTheme = theme;
        root.setAttribute('data-theme', theme);
        if (toggleBtn) {
            toggleBtn.textContent = theme === 'dark'
                ? '‚òÄ Jasny motyw'
                : 'üåô Ciemny motyw';
        }
    }

    // Ustal motyw przy starcie ‚Äì z localStorage lub z preferencji systemu
    const saved = localStorage.getItem(STORAGE_KEY);
    const prefersDark = window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches;

    applyTheme(saved || (prefersDark ? 'dark' : 'light'));

    window.addEventListener('DOMContentLoaded', function () {
        toggleBtn = document.getElementById('theme-toggle');
        if (!toggleBtn) return;

        // Ustaw labelkƒô zgodnie z aktualnym motywem
        applyTheme(currentTheme);

        toggleBtn.addEventListener('click', function () {
            const next = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(next);
            localStorage.setItem(STORAGE_KEY, next);
        });
    });
})();
</script>

</body>
</html>
